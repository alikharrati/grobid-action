name: Run GROBID

on:
  workflow_dispatch:  # این بخش به شما امکان می‌دهد به‌صورت دستی این workflow را اجرا کنید.

jobs:
  build:
    runs-on: ubuntu-latest  # از یک سرور مجازی اوبونتو برای اجرای GROBID استفاده می‌کنیم

    steps:
    - name: Checkout the repository
      uses: actions/checkout@v2  # مخزن را دریافت می‌کند

    - name: Set up JDK 11
      uses: actions/setup-java@v1  # جاوا نسخه 11 را تنظیم می‌کند
      with:
        java-version: '11'

    - name: Download GROBID
      run: |
        wget https://github.com/kermitt2/grobid/archive/refs/heads/master.zip
        unzip master.zip

    - name: Build GROBID
      run: |
        cd grobid-master
        ./gradlew clean install  # GROBID را می‌سازد

    - name: Run GROBID
      run: |
        cd grobid-master
        ./gradlew run &  # GROBID را اجرا می‌کند
        sleep 10  # به GROBID زمان می‌دهد تا اجرا شود

    - name: Test GROBID API
      run: |
        curl -F "input=@/path/to/sample.pdf" localhost:8070/api/processHeaderDocument  # یک فایل نمونه PDF را برای تست ارسال می‌کند
