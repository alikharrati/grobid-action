name: Run GROBID

on:
  workflow_dispatch:  # امکان اجرای دستی workflow

jobs:
  build:
    runs-on: ubuntu-latest  # اجرای در سرور ابونتو

    steps:
    - name: Checkout the repository
      uses: actions/checkout@v2  # دریافت کد از مخزن

    - name: Set up JDK 11
      uses: actions/setup-java@v1  # تنظیم جاوا 11
      with:
        java-version: '11'

    - name: Download GROBID
      run: |
        wget https://github.com/kermitt2/grobid/archive/refs/heads/master.zip
        unzip master.zip

    - name: Build GROBID
      run: |
        cd grobid-master
        ./gradlew clean install

    - name: Run GROBID
      run: |
        cd grobid-master
        ./gradlew run &
        sleep 10  # به GROBID زمان اجرا بدهید

    - name: Test GROBID API
      run: |
        curl -F "input=@./2024-05-30 - Food - EN.pdf" localhost:8070/api/processHeaderDocument
